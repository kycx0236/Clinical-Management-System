{% extends 'base.html' %}
{% block title %}DocCare | View Appointment{% endblock title %}
{% block link %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='receptionist_view_style.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
{% endblock link %}

{% block content %}
<body>
    <div class="doccare-view-container">
        <span class="material-symbols-outlined arrow" id="arrow">arrow_back</span>
        <div class="doccare-view-content">
            <div class="doccare-first">
                <span class="material-symbols-outlined info">info</span> 
                <label class="doccare-header"> DETAILS </label>
                <span class="line"> </span>
            </div>
            
            <div class="fields" id="fields">
                <div class="doccare-second">
                    <label class="doccare-subheader"> BOOKING DETAILS </label>
                    
                    <label class="doccare-text"> BOOKING DATE </label>
                    <label class="doccare-detail"> {{ row.book_date}} </label>
                    
                    <label class="doccare-text"> BOOKING REFERENCE </label>
                    <label class="doccare-detail reference"> {{ row.reference_number }} </label>
                </div>

                <div class="doccare-third">
                    <label class="doccare-subheader"> PATIENT'S DETAILS </label>
                    
                    <label class="doccare-text"> NAME </label>
                    <!-- Replace occurrences of row.first_name, row.middle_name, row.last_name -->
                    <label class="doccare-detail"> {{ row.appointment_first_name }} {{ row.appointment_middle_name }} {{ row.appointment_last_name }} </label>
                    
                    <label class="doccare-text"> SEX </label>
                    <label class="doccare-detail"> {{ row.sex }} </label>

                    <label class="doccare-text"> DATE OF BIRTH </label>
                    <label class="doccare-detail"> {{ row.birth_date }} </label>

                    <label class="doccare-text"> CONTACT NUMBER </label>
                    <label class="doccare-detail"> {{ row.contact_number }} </label>

                    <label class="doccare-text"> EMAIL </label>
                    <label class="doccare-detail"> {{ row.email }} </label>

                    <label class="doccare-text"> ADDRESS </label>
                    <label class="doccare-detail"> {{ row.address }} </label>
                </div>

                <div class="doccare-fourth">
                    <label class="doccare-subheader"> APPOINMENT DETAILS </label>
                    <label class="doccare-text">APPOINTMENT DATE AND TIME: </label>
                    <label class="doccare-detail"> {{ row.date_appointment }} : {{ row.time_appointment }} </label>

                    <label class="doccare-text"> STATUS </label>
                    <label class="doccare-detail status"> {{ row.status_ }} </label>

                    <label class="doccare-text"> DOCTOR DETAILS </label>
                    <!-- Replace occurrences of row.first_name -->
                    <label class="doccare-detail"> {{ row.user_first_name }} {{ row.user_middle_name }} {{ row.user_last_name }}  </label>
                </div>
            </div>

            <div>
                <!-- Include a hidden input for student id_number to view the details -->
                <input type="hidden" name="reference_number" value="{{ row.reference_number }}">
                <button type=" button" class="doccare-done-button" id="doccare-done-button">Done</button>
            </div>
        </div>
    </div>
</body>
<!-- Include these script tags -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename="doctor_view_script.js") }}"></script>
<script>
    // NOTIFICATION
    var box  = document.getElementById('box');
        var down = false;

        function toggleNotifi(){
            if (down) {
                box.style.height  = '0px';
                box.style.opacity = 0;
                down = false;
            } else {
                box.style.height  = '360px';
                box.style.opacity = 1;
                down = true;
            }
        }

        function setupSocketIO() {
            var socket = io.connect('http://' + document.domain + ':' + location.port);
            socket.on('connect', function() {
                console.log('SocketIO connected!');
            });

            socket.on('new_lab_report_notification', function(data) {
                console.log('Notification data');
            
                alert('Laboratory report has been sent!');
                window.location.reload(); 
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            setupSocketIO();
        });
</script>
{% endblock %}